L'installation décrite correspond à celle que nous utilisons, dans certains cas des adresses fixes et non relatives ont du être utilisé dans notre développement donc si une autre structure est retenue il faudra corriger en conséquence les adresses fixes.

Sur notre serveur Linux nous avons créer un utilisateur 'sig' et dans son home nous avons créé les répertoires intranet, internet et test_ssl(extranet).
/home
  |_>sig
      |_>intranet
      |_>internet
      |_>test_ssl

 Copier les fichiers dans les repertoires correspondants.ou svn:????

Créer les liens symboliques.
	Dans répertoire internet
		logo ->intranet/logo
		tmp -> intranet/tmp
		interface -> intranet/interface
		connexion -> intranet/connexion
		fpdf -> intranet/fpdf
		ru -> intranet/ru
		rrrr.php -> intranet/rrrr.php
	Dans répertoire test_ssl
		cgi-bin -> /var/www/cgi-bin
		interface -> intranet/interface
		logo -> intranet/logo

Créer la tâche cron de nettoyage du répertoire 'intranet/tmp' a effectué toutes les 1/2 heures (script 'clean_tmp.dd').

Créer les tables comme décrit dans table.txt. Remplacer '"+pg_utilis+"' par l'utilisateur postgres.
Dans la table commune mettre la valeur par defaut de 'idagglo' à une valeur département(2c)+agglo(1c)+000
Dans la création du superadministrateur modifier la valeur 'idcommune' pour lui permettre d'afficher les cartes communales, mais seul l'utilisateur 'sig1' peut voir tous les utilisateurs, les autres administrateurs voient les utilisateurs de leur agglomération, pas de gestion des utilisateurs au niveau communal.
Dans postgres dans le schema 'general' table 'testmenu' les valeurs correspondent à celle de notre site !!! à modifier dés la fin des tests.Il s'agit du menu du site internet.Une prochaine version devrait pour la partie réglement lire directement le contenu du repertoire de la commune concernée.

Insertion BDTOPO
copier les données au format shapefile dans un répertoire, puis dans une console lancer "./maj.sh repdelabdtopo bd_topo nomdelabase" qui se chargera d'insérer les données de la BDTOPO dans postgrès.

créer la commune dans la table commune.
si BDTOPO commande sql "insert into admin_svg.commune (select *,envelope(the_geom),xmax(the_geom),xmin(the_geom),ymax(the_geom),ymin(the_geom),'idagglo' from bd_topo.commune);"
sinon récupérer périmètre communal dans cadastre "insert into admin_svg.commune (nom,idcommune,canton,the_geom,enveloppe,xma,xmi,yma,ymi) (select first(lower(tex2)),code_insee,'nom du canton',the_geom,envelope(the_geom),xmax(the_geom),xmin(the_geom),ymax(the_geom),ymin(the_geom) from test_cadastre.commune)"
sinon donner coordonnées de la fenetre englobante

modifier le fichier interface/config.php
dans la variable $config_serveur_smtp insérer la valeur du serveur smtp utilisable par le serveur du sig.

modifier intranet/connexion/deb.php et test_ssl/connexion/deb.php
en ligne 34 remplacer par vos valeurs basepg, userpg, passpg

modification httpd.conf
dans le cas d'une fedora core 5:
	UseCanonicalName On
	DocumentRoot /home/sig/intranet/
modifier la directory de l'ancien DocumentRoot
	<Directory "/home/sig/intranet/">
	    Options -Indexes FollowSymLinks ExecCGI
	    AllowOverride None
	    Order allow,deny
	    Allow from all
	</Directory>
modifier le VirtualHost example
	<VirtualHost 126.2.0.100:80>
	    ServerName stest
	    ServerAlias stest.meaux.priv stest.meaux
	</VirtualHost>

modification conf.d/ssl.conf
	DocumentRoot "/home/sig/test_ssl"
	ServerName www.pays.fr:443
	ServerAlias pays.fr pays
	ServerAdmin sig@localhost #si serveur smtp en local
attention apache n'autorise qu'un seul serveur ssl

modification phpPgAdmin.conf
ajoutez à la ligne "Allow from 127.0.0.1" les adresses IP de la ou des personnes chargés d'administrés les données du sig, séparé par un espace.

modifier le style par défaut intranet/interface/css/default.css et renommer en code département(2c)+code agglo(1c)+codeinsee dela commune ('000' si agglo).css

insérer logo dans intranet/logo et enregistrer référence dans table admin_svg.commune.
